<!DOCTYPE html>
{% load bidi i18n static %}
{# View will have set current language #}
{% get_current_language as LANGUAGE_CODE %}
{% get_language_info for LANGUAGE_CODE as lang %}
<html lang="{{ lang.code }}" dir="{% if lang.bidi %}rtl{% else %}ltr{% endif %}">
<head about="{% block head_about %}{% endblock %}">
  <meta charset="utf-8"/>
  <title>{% block title %}{% endblock %}</title>
  <meta name="CC-Canonical-URL" content="{% block tool_canonical_url %}{% endblock %}"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  {% block head_meta %}
  {% endblock %}
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bulma@0.9.0/css/bulma.min.css"
  />
  <link
    rel="stylesheet"
    href="https://unpkg.com/@creativecommons/fonts@2020.9.3/css/fonts.css"
  />
  <link
    rel="stylesheet"
    href="https://unpkg.com/@creativecommons/vocabulary@v2020.11.3/css/vocabulary.css"
  />
  <!-- Import Vue JS via CDN -->
  <script src="https://unpkg.com/vue@next"></script>
  <!-- Import Axios via CDN. Needed for the Global Header Component -->
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <!-- Import the Component Library via CDN -->
  <script src="https://unpkg.com/@creativecommons/cc-global-components@0.x.x/dist/cc-globals.min.js"></script>
</head>
<body typeof="{% block body_typeof %}{% endblock %}" about="{% block body_about %}{% endblock %}">
  {% include 'includes/header.html' %}
  <main>
    <div class="level padding-{% bidi_start %}-big padding-{% bidi_end %}-large padding-vertical-normal">
      {% include 'includes/skiplink.html' %}
      <nav class="breadcrumb level-left caption bold" aria-label="breadcrumbs">
        <ul>
          <li><a href="/">{% trans "Home" %}</a></li>
          <li><a href="/{{ category }}/">{% trans category_title %}</a></li>
          {% block active-breadcrumb-li %}{% endblock %}
        </ul>
      </nav>
      {% if languages_and_links %}
        {% include "includes/languages_dropdown.html" %}
      {% endif %}
    </div>
    <section id="content" class="padding-horizontal-larger">
      {% block next_btn_section %}{% endblock %}
      {% block content %}{% endblock %}
    </section>
  </main>
  {% include 'includes/footer.html' %}

  <script src="https://cdn.jsdelivr.net/npm/@creativecommons/vocabulary@v2020.11.1/js/vocabulary.js"></script>

  <script>
    /**
    * Get the fully-qualified URL of a Vocabulary asset.
    *
    * @param {string} version - the Vocabulary version in which to locate the asset
    * @param {string} path - the path of the asset being patched
    * @return {string} the fully qualified URL of the asset
    */
    const getFullyQualifiedUrl = (version, path) => {
    //   let baseUrl = 'https://unpkg.com/@creativecommons/vocabulary'
      // If you prefer jsDelivr instead, use
      let baseUrl = 'https://cdn.jsdelivr.net/npm/@creativecommons/vocabulary'
      return `${baseUrl}@${version}/${path}`
    }

    /**
    * Create an invisible container and place the asset into the DOM.
    *
    * This function is intended to be used to patch SVG assets that are later
    * referenced inside `<use>` tags in `<svg>` tags. It can also be used to force
    * an image to be downloaded to speed up its loading when referenced again.
    *
    * @param {string} path - the path of the asset being patched
    * @param {string} version - the Vocabulary version in which to locate the asset
    */
    const patchAssetIntoDom = (path, version = 'latest') => {
      fetch(getFullyQualifiedUrl(version, path)).then(response => {
        return response.text()
      }).then(data => {
        // Render SVG in the page
        const logo = document.querySelector('#cc-logo')
        const footerLogo = document.querySelector('#cc-footer-logo')
        logo.innerHTML = data;
        footerLogo.innerHTML = data;
      })
    }

    patchAssetIntoDom('assets/logos/cc/logomark.svg');

    /** Next Button On Click Event Listener **/
    document.getElementById("next-btn").addEventListener("click", function (e) {
      /**
      * On click redirect the user to page they are trying to visit
      * which is stored in the data-href.
      **/
      return window.location.href = this.dataset.href
    })
  </script>
  <script>
    /* Import and use the Explore CC component */
    const cc_explore = Vue.createApp({});
    cc_explore.use(CcGlobals);
    cc_explore.mount("#explore-cc");

    /* Import and use the CC Global Header component */
    const cc_header = Vue.createApp({});
    cc_header.use(CcGlobals);
    cc_header.mount("#header-cc");

    /* Import and use the CC Global Footer component */
    const cc_footer = Vue.createApp({});
    cc_footer.use(CcGlobals);
    cc_footer.mount("#footer-cc");
  </script>
  {% block extra-js %}
  {% endblock %}
  </body>
  <style>
    body {
      background-color: rgb(245, 245, 245);
    }
    html[dir="rtl"] nav.breadcrumb>ul li+li:before {
      transform: scaleX(-1);
    }
    html[dir="rtl"] .breadcrumb li:first-child a {
      padding-right: 0;
      padding-left: .5rem;
    }
  </style>
</html>
{# vim: ft=jinja.html ts=2 sw=2 sts=2 sr et #}
